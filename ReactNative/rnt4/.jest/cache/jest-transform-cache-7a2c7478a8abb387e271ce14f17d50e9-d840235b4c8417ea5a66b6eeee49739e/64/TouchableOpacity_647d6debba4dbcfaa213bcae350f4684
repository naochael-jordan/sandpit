41d887806e324d3f7e340aea8eb98084


'use strict';

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var Animated = require('Animated');
var Easing = require('Easing');
var NativeMethodsMixin = require('NativeMethodsMixin');
var React = require('React');
var PropTypes = require('prop-types');
var TimerMixin = require('react-timer-mixin');
var Touchable = require('Touchable');
var TouchableWithoutFeedback = require('TouchableWithoutFeedback');

var createReactClass = require('create-react-class');
var ensurePositiveDelayProps = require('ensurePositiveDelayProps');
var flattenStyle = require('flattenStyle');

var PRESS_RETENTION_OFFSET = { top: 20, left: 20, right: 20, bottom: 30 };

var TouchableOpacity = createReactClass({
  displayName: 'TouchableOpacity',
  mixins: [TimerMixin, Touchable.Mixin, NativeMethodsMixin],

  propTypes: _extends({}, TouchableWithoutFeedback.propTypes, {
    activeOpacity: PropTypes.number,

    hasTVPreferredFocus: PropTypes.bool,

    tvParallaxProperties: PropTypes.object
  }),

  getDefaultProps: function getDefaultProps() {
    return {
      activeOpacity: 0.2
    };
  },

  getInitialState: function getInitialState() {
    return _extends({}, this.touchableGetInitialState(), {
      anim: new Animated.Value(this._getChildStyleOpacityWithDefault())
    });
  },

  componentDidMount: function componentDidMount() {
    ensurePositiveDelayProps(this.props);
  },

  UNSAFE_componentWillReceiveProps: function UNSAFE_componentWillReceiveProps(nextProps) {
    ensurePositiveDelayProps(nextProps);
  },

  componentDidUpdate: function componentDidUpdate(prevProps, prevState) {
    if (this.props.disabled !== prevProps.disabled) {
      this._opacityInactive(250);
    }
  },

  setOpacityTo: function setOpacityTo(value, duration) {
    Animated.timing(this.state.anim, {
      toValue: value,
      duration: duration,
      easing: Easing.inOut(Easing.quad),
      useNativeDriver: true
    }).start();
  },

  touchableHandleActivePressIn: function touchableHandleActivePressIn(e) {
    if (e.dispatchConfig.registrationName === 'onResponderGrant') {
      this._opacityActive(0);
    } else {
      this._opacityActive(150);
    }
    this.props.onPressIn && this.props.onPressIn(e);
  },

  touchableHandleActivePressOut: function touchableHandleActivePressOut(e) {
    this._opacityInactive(250);
    this.props.onPressOut && this.props.onPressOut(e);
  },

  touchableHandlePress: function touchableHandlePress(e) {
    this.props.onPress && this.props.onPress(e);
  },

  touchableHandleLongPress: function touchableHandleLongPress(e) {
    this.props.onLongPress && this.props.onLongPress(e);
  },

  touchableGetPressRectOffset: function touchableGetPressRectOffset() {
    return this.props.pressRetentionOffset || PRESS_RETENTION_OFFSET;
  },

  touchableGetHitSlop: function touchableGetHitSlop() {
    return this.props.hitSlop;
  },

  touchableGetHighlightDelayMS: function touchableGetHighlightDelayMS() {
    return this.props.delayPressIn || 0;
  },

  touchableGetLongPressDelayMS: function touchableGetLongPressDelayMS() {
    return this.props.delayLongPress === 0 ? 0 : this.props.delayLongPress || 500;
  },

  touchableGetPressOutDelayMS: function touchableGetPressOutDelayMS() {
    return this.props.delayPressOut;
  },

  _opacityActive: function _opacityActive(duration) {
    this.setOpacityTo(this.props.activeOpacity, duration);
  },

  _opacityInactive: function _opacityInactive(duration) {
    this.setOpacityTo(this._getChildStyleOpacityWithDefault(), duration);
  },

  _getChildStyleOpacityWithDefault: function _getChildStyleOpacityWithDefault() {
    var childStyle = flattenStyle(this.props.style) || {};
    return childStyle.opacity == undefined ? 1 : childStyle.opacity;
  },

  render: function render() {
    return React.createElement(
      Animated.View,
      {
        accessible: this.props.accessible !== false,
        accessibilityLabel: this.props.accessibilityLabel,
        accessibilityHint: this.props.accessibilityHint,
        accessibilityRole: this.props.accessibilityRole,
        accessibilityStates: this.props.accessibilityStates,
        style: [this.props.style, { opacity: this.state.anim }],
        nativeID: this.props.nativeID,
        testID: this.props.testID,
        onLayout: this.props.onLayout,
        isTVSelectable: true,
        hasTVPreferredFocus: this.props.hasTVPreferredFocus,
        tvParallaxProperties: this.props.tvParallaxProperties,
        hitSlop: this.props.hitSlop,
        onStartShouldSetResponder: this.touchableHandleStartShouldSetResponder,
        onResponderTerminationRequest: this.touchableHandleResponderTerminationRequest,
        onResponderGrant: this.touchableHandleResponderGrant,
        onResponderMove: this.touchableHandleResponderMove,
        onResponderRelease: this.touchableHandleResponderRelease,
        onResponderTerminate: this.touchableHandleResponderTerminate },
      this.props.children,
      Touchable.renderDebugView({
        color: 'cyan',
        hitSlop: this.props.hitSlop
      })
    );
  }
});

module.exports = TouchableOpacity;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRvdWNoYWJsZU9wYWNpdHkuanMiXSwibmFtZXMiOlsiQW5pbWF0ZWQiLCJyZXF1aXJlIiwiRWFzaW5nIiwiTmF0aXZlTWV0aG9kc01peGluIiwiUmVhY3QiLCJQcm9wVHlwZXMiLCJUaW1lck1peGluIiwiVG91Y2hhYmxlIiwiVG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrIiwiY3JlYXRlUmVhY3RDbGFzcyIsImVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyIsImZsYXR0ZW5TdHlsZSIsIlBSRVNTX1JFVEVOVElPTl9PRkZTRVQiLCJ0b3AiLCJsZWZ0IiwicmlnaHQiLCJib3R0b20iLCJUb3VjaGFibGVPcGFjaXR5IiwiZGlzcGxheU5hbWUiLCJtaXhpbnMiLCJNaXhpbiIsInByb3BUeXBlcyIsImFjdGl2ZU9wYWNpdHkiLCJudW1iZXIiLCJoYXNUVlByZWZlcnJlZEZvY3VzIiwiYm9vbCIsInR2UGFyYWxsYXhQcm9wZXJ0aWVzIiwib2JqZWN0IiwiZ2V0RGVmYXVsdFByb3BzIiwiZ2V0SW5pdGlhbFN0YXRlIiwidG91Y2hhYmxlR2V0SW5pdGlhbFN0YXRlIiwiYW5pbSIsIlZhbHVlIiwiX2dldENoaWxkU3R5bGVPcGFjaXR5V2l0aERlZmF1bHQiLCJjb21wb25lbnREaWRNb3VudCIsInByb3BzIiwiVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMiLCJuZXh0UHJvcHMiLCJjb21wb25lbnREaWRVcGRhdGUiLCJwcmV2UHJvcHMiLCJwcmV2U3RhdGUiLCJkaXNhYmxlZCIsIl9vcGFjaXR5SW5hY3RpdmUiLCJzZXRPcGFjaXR5VG8iLCJ2YWx1ZSIsImR1cmF0aW9uIiwidGltaW5nIiwic3RhdGUiLCJ0b1ZhbHVlIiwiZWFzaW5nIiwiaW5PdXQiLCJxdWFkIiwidXNlTmF0aXZlRHJpdmVyIiwic3RhcnQiLCJ0b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc0luIiwiZSIsImRpc3BhdGNoQ29uZmlnIiwicmVnaXN0cmF0aW9uTmFtZSIsIl9vcGFjaXR5QWN0aXZlIiwib25QcmVzc0luIiwidG91Y2hhYmxlSGFuZGxlQWN0aXZlUHJlc3NPdXQiLCJvblByZXNzT3V0IiwidG91Y2hhYmxlSGFuZGxlUHJlc3MiLCJvblByZXNzIiwidG91Y2hhYmxlSGFuZGxlTG9uZ1ByZXNzIiwib25Mb25nUHJlc3MiLCJ0b3VjaGFibGVHZXRQcmVzc1JlY3RPZmZzZXQiLCJwcmVzc1JldGVudGlvbk9mZnNldCIsInRvdWNoYWJsZUdldEhpdFNsb3AiLCJoaXRTbG9wIiwidG91Y2hhYmxlR2V0SGlnaGxpZ2h0RGVsYXlNUyIsImRlbGF5UHJlc3NJbiIsInRvdWNoYWJsZUdldExvbmdQcmVzc0RlbGF5TVMiLCJkZWxheUxvbmdQcmVzcyIsInRvdWNoYWJsZUdldFByZXNzT3V0RGVsYXlNUyIsImRlbGF5UHJlc3NPdXQiLCJjaGlsZFN0eWxlIiwic3R5bGUiLCJvcGFjaXR5IiwidW5kZWZpbmVkIiwicmVuZGVyIiwiYWNjZXNzaWJsZSIsImFjY2Vzc2liaWxpdHlMYWJlbCIsImFjY2Vzc2liaWxpdHlIaW50IiwiYWNjZXNzaWJpbGl0eVJvbGUiLCJhY2Nlc3NpYmlsaXR5U3RhdGVzIiwibmF0aXZlSUQiLCJ0ZXN0SUQiLCJvbkxheW91dCIsInRvdWNoYWJsZUhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyIiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0IiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyR3JhbnQiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJNb3ZlIiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyUmVsZWFzZSIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0ZSIsImNoaWxkcmVuIiwicmVuZGVyRGVidWdWaWV3IiwiY29sb3IiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQVVBOzs7O0FBRUEsSUFBTUEsV0FBV0MsUUFBUSxVQUFSLENBQWpCO0FBQ0EsSUFBTUMsU0FBU0QsUUFBUSxRQUFSLENB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VXlGLGVBQVYsQ0FBMEI7QUFDekJDLGVBQU8sTUFEa0I7QUFFekI1QixpQkFBUyxLQUFLbEMsS0FBTCxDQUFXa0M7QUFGSyxPQUExQjtBQXZCSCxLQURGO0FBOEJEO0FBeEp5QyxDQUFqQixDQUEzQjs7QUEySkE2QixPQUFPQyxPQUFQLEdBQWlCbEYsZ0JBQWpCIiwiZmlsZSI6IlRvdWNoYWJsZU9wYWNpdHkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmb3JtYXRcbiAqIEBmbG93XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBBbmltYXRlZCA9IHJlcXVpcmUoJ0FuaW1hdGVkJyk7XG5jb25zdCBFYXNpbmcgPSByZXF1aXJlKCdFYXNpbmcnKTtcbmNvbnN0IE5hdGl2ZU1ldGhvZHNNaXhpbiA9IHJlcXVpcmUoJ05hdGl2ZU1ldGhvZHNNaXhpbicpO1xuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdSZWFjdCcpO1xuY29uc3QgUHJvcFR5cGVzID0gcmVxdWlyZSgncHJvcC10eXBlcycpO1xuY29uc3QgVGltZXJNaXhpbiA9IHJlcXVpcmUoJ3JlYWN0LXRpbWVyLW1peGluJyk7XG5jb25zdCBUb3VjaGFibGUgPSByZXF1aXJlKCdUb3VjaGFibGUnKTtcbmNvbnN0IFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayA9IHJlcXVpcmUoJ1RvdWNoYWJsZVdpdGhvdXRGZWVkYmFjaycpO1xuXG5jb25zdCBjcmVhdGVSZWFjdENsYXNzID0gcmVxdWlyZSgnY3JlYXRlLXJlYWN0LWNsYXNzJyk7XG5jb25zdCBlbnN1cmVQb3NpdGl2ZURlbGF5UHJvcHMgPSByZXF1aXJlKCdlbnN1cmVQb3NpdGl2ZURlbGF5UHJvcHMnKTtcbmNvbnN0IGZsYXR0ZW5TdHlsZSA9IHJlcXVpcmUoJ2ZsYXR0ZW5TdHlsZScpO1xuXG5pbXBvcnQgdHlwZSB7UHJvcHMgYXMgVG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrUHJvcHN9IGZyb20gJ1RvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayc7XG5pbXBvcnQgdHlwZSB7Vmlld1N0eWxlUHJvcH0gZnJvbSAnU3R5bGVTaGVldCc7XG5cbnR5cGUgRXZlbnQgPSBPYmplY3Q7XG5cbmNvbnN0IFBSRVNTX1JFVEVOVElPTl9PRkZTRVQgPSB7dG9wOiAyMCwgbGVmdDogMjAsIHJpZ2h0OiAyMCwgYm90dG9tOiAzMH07XG5cbnR5cGUgVFZQcm9wcyA9ICRSZWFkT25seTx7fFxuICBoYXNUVlByZWZlcnJlZEZvY3VzPzogP2Jvb2xlYW4sXG4gIHR2UGFyYWxsYXhQcm9wZXJ0aWVzPzogP09iamVjdCxcbnx9PjtcblxudHlwZSBQcm9wcyA9ICRSZWFkT25seTx7fFxuICAuLi5Ub3VjaGFibGVXaXRob3V0RmVlZGJhY2tQcm9wcyxcbiAgLi4uVFZQcm9wcyxcbiAgYWN0aXZlT3BhY2l0eT86ID9udW1iZXIsXG4gIHN0eWxlPzogP1ZpZXdTdHlsZVByb3AsXG58fT47XG5cbi8qKlxuICogQSB3cmFwcGVyIGZvciBtYWtpbmcgdmlld3MgcmVzcG9uZCBwcm9wZXJseSB0byB0b3VjaGVzLlxuICogT24gcHJlc3MgZG93biwgdGhlIG9wYWNpdHkgb2YgdGhlIHdyYXBwZWQgdmlldyBpcyBkZWNyZWFzZWQsIGRpbW1pbmcgaXQuXG4gKlxuICogT3BhY2l0eSBpcyBjb250cm9sbGVkIGJ5IHdyYXBwaW5nIHRoZSBjaGlsZHJlbiBpbiBhbiBBbmltYXRlZC5WaWV3LCB3aGljaCBpc1xuICogYWRkZWQgdG8gdGhlIHZpZXcgaGllYXJjaHkuICBCZSBhd2FyZSB0aGF0IHRoaXMgY2FuIGFmZmVjdCBsYXlvdXQuXG4gKlxuICogRXhhbXBsZTpcbiAqXG4gKiBgYGBcbiAqIHJlbmRlckJ1dHRvbjogZnVuY3Rpb24oKSB7XG4gKiAgIHJldHVybiAoXG4gKiAgICAgPFRvdWNoYWJsZU9wYWNpdHkgb25QcmVzcz17dGhpcy5fb25QcmVzc0J1dHRvbn0+XG4gKiAgICAgICA8SW1hZ2VcbiAqICAgICAgICAgc3R5bGU9e3N0eWxlcy5idXR0b259XG4gKiAgICAgICAgIHNvdXJjZT17cmVxdWlyZSgnLi9teUJ1dHRvbi5wbmcnKX1cbiAqICAgICAgIC8+XG4gKiAgICAgPC9Ub3VjaGFibGVPcGFjaXR5PlxuICogICApO1xuICogfSxcbiAqIGBgYFxuICogIyMjIEV4YW1wbGVcbiAqXG4gKiBgYGBSZWFjdE5hdGl2ZVdlYlBsYXllclxuICogaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0J1xuICogaW1wb3J0IHtcbiAqICAgQXBwUmVnaXN0cnksXG4gKiAgIFN0eWxlU2hlZXQsXG4gKiAgIFRvdWNoYWJsZU9wYWNpdHksXG4gKiAgIFRleHQsXG4gKiAgIFZpZXcsXG4gKiB9IGZyb20gJ3JlYWN0LW5hdGl2ZSdcbiAqXG4gKiBjbGFzcyBBcHAgZXh0ZW5kcyBDb21wb25lbnQge1xuICogICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICogICAgIHN1cGVyKHByb3BzKVxuICogICAgIHRoaXMuc3RhdGUgPSB7IGNvdW50OiAwIH1cbiAqICAgfVxuICpcbiAqICAgb25QcmVzcyA9ICgpID0+IHtcbiAqICAgICB0aGlzLnNldFN0YXRlKHtcbiAqICAgICAgIGNvdW50OiB0aGlzLnN0YXRlLmNvdW50KzFcbiAqICAgICB9KVxuICogICB9XG4gKlxuICogIHJlbmRlcigpIHtcbiAqICAgIHJldHVybiAoXG4gKiAgICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGFpbmVyfT5cbiAqICAgICAgICA8VG91Y2hhYmxlT3BhY2l0eVxuICogICAgICAgICAgc3R5bGU9e3N0eWxlcy5idXR0b259XG4gKiAgICAgICAgICBvblByZXNzPXt0aGlzLm9uUHJlc3N9XG4gKiAgICAgICAgPlxuICogICAgICAgICAgPFRleHQ+IFRvdWNoIEhlcmUgPC9UZXh0PlxuICogICAgICAgIDwvVG91Y2hhYmxlT3BhY2l0eT5cbiAqICAgICAgICA8VmlldyBzdHlsZT17W3N0eWxlcy5jb3VudENvbnRhaW5lcl19PlxuICogICAgICAgICAgPFRleHQgc3R5bGU9e1tzdHlsZXMuY291bnRUZXh0XX0+XG4gKiAgICAgICAgICAgICB7IHRoaXMuc3RhdGUuY291bnQgIT09IDAgPyB0aGlzLnN0YXRlLmNvdW50OiBudWxsfVxuICogICAgICAgICAgIDwvVGV4dD5cbiAqICAgICAgICAgPC9WaWV3PlxuICogICAgICAgPC9WaWV3PlxuICogICAgIClcbiAqICAgfVxuICogfVxuICpcbiAqIGNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAqICAgY29udGFpbmVyOiB7XG4gKiAgICAgZmxleDogMSxcbiAqICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gKiAgICAgcGFkZGluZ0hvcml6b250YWw6IDEwXG4gKiAgIH0sXG4gKiAgIGJ1dHRvbjoge1xuICogICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICogICAgIGJhY2tncm91bmRDb2xvcjogJyNEREREREQnLFxuICogICAgIHBhZGRpbmc6IDEwXG4gKiAgIH0sXG4gKiAgIGNvdW50Q29udGFpbmVyOiB7XG4gKiAgICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gKiAgICAgcGFkZGluZzogMTBcbiAqICAgfSxcbiAqICAgY291bnRUZXh0OiB7XG4gKiAgICAgY29sb3I6ICcjRkYwMEZGJ1xuICogICB9XG4gKiB9KVxuICpcbiAqIEFwcFJlZ2lzdHJ5LnJlZ2lzdGVyQ29tcG9uZW50KCdBcHAnLCAoKSA9PiBBcHApXG4gKiBgYGBcbiAqXG4gKi9cbmNvbnN0IFRvdWNoYWJsZU9wYWNpdHkgPSAoKGNyZWF0ZVJlYWN0Q2xhc3Moe1xuICBkaXNwbGF5TmFtZTogJ1RvdWNoYWJsZU9wYWNpdHknLFxuICBtaXhpbnM6IFtUaW1lck1peGluLCBUb3VjaGFibGUuTWl4aW4sIE5hdGl2ZU1ldGhvZHNNaXhpbl0sXG5cbiAgcHJvcFR5cGVzOiB7XG4gICAgLi4uVG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrLnByb3BUeXBlcyxcbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIHdoYXQgdGhlIG9wYWNpdHkgb2YgdGhlIHdyYXBwZWQgdmlldyBzaG91bGQgYmUgd2hlbiB0b3VjaCBpc1xuICAgICAqIGFjdGl2ZS4gRGVmYXVsdHMgdG8gMC4yLlxuICAgICAqL1xuICAgIGFjdGl2ZU9wYWNpdHk6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgLyoqXG4gICAgICogVFYgcHJlZmVycmVkIGZvY3VzIChzZWUgZG9jdW1lbnRhdGlvbiBmb3IgdGhlIFZpZXcgY29tcG9uZW50KS5cbiAgICAgKi9cbiAgICBoYXNUVlByZWZlcnJlZEZvY3VzOiBQcm9wVHlwZXMuYm9vbCxcbiAgICAvKipcbiAgICAgKiBBcHBsZSBUViBwYXJhbGxheCBlZmZlY3RzXG4gICAgICovXG4gICAgdHZQYXJhbGxheFByb3BlcnRpZXM6IFByb3BUeXBlcy5vYmplY3QsXG4gIH0sXG5cbiAgZ2V0RGVmYXVsdFByb3BzOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYWN0aXZlT3BhY2l0eTogMC4yLFxuICAgIH07XG4gIH0sXG5cbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4udGhpcy50b3VjaGFibGVHZXRJbml0aWFsU3RhdGUoKSxcbiAgICAgIGFuaW06IG5ldyBBbmltYXRlZC5WYWx1ZSh0aGlzLl9nZXRDaGlsZFN0eWxlT3BhY2l0eVdpdGhEZWZhdWx0KCkpLFxuICAgIH07XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIGVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyh0aGlzLnByb3BzKTtcbiAgfSxcblxuICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24obmV4dFByb3BzKSB7XG4gICAgZW5zdXJlUG9zaXRpdmVEZWxheVByb3BzKG5leHRQcm9wcyk7XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkVXBkYXRlOiBmdW5jdGlvbihwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgIGlmICh0aGlzLnByb3BzLmRpc2FibGVkICE9PSBwcmV2UHJvcHMuZGlzYWJsZWQpIHtcbiAgICAgIHRoaXMuX29wYWNpdHlJbmFjdGl2ZSgyNTApO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogQW5pbWF0ZSB0aGUgdG91Y2hhYmxlIHRvIGEgbmV3IG9wYWNpdHkuXG4gICAqL1xuICBzZXRPcGFjaXR5VG86IGZ1bmN0aW9uKHZhbHVlOiBudW1iZXIsIGR1cmF0aW9uOiBudW1iZXIpIHtcbiAgICBBbmltYXRlZC50aW1pbmcodGhpcy5zdGF0ZS5hbmltLCB7XG4gICAgICB0b1ZhbHVlOiB2YWx1ZSxcbiAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbixcbiAgICAgIGVhc2luZzogRWFzaW5nLmluT3V0KEVhc2luZy5xdWFkKSxcbiAgICAgIHVzZU5hdGl2ZURyaXZlcjogdHJ1ZSxcbiAgICB9KS5zdGFydCgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBgVG91Y2hhYmxlLk1peGluYCBzZWxmIGNhbGxiYWNrcy4gVGhlIG1peGluIHdpbGwgaW52b2tlIHRoZXNlIGlmIHRoZXkgYXJlXG4gICAqIGRlZmluZWQgb24geW91ciBjb21wb25lbnQuXG4gICAqL1xuICB0b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc0luOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIGlmIChlLmRpc3BhdGNoQ29uZmlnLnJlZ2lzdHJhdGlvbk5hbWUgPT09ICdvblJlc3BvbmRlckdyYW50Jykge1xuICAgICAgdGhpcy5fb3BhY2l0eUFjdGl2ZSgwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fb3BhY2l0eUFjdGl2ZSgxNTApO1xuICAgIH1cbiAgICB0aGlzLnByb3BzLm9uUHJlc3NJbiAmJiB0aGlzLnByb3BzLm9uUHJlc3NJbihlKTtcbiAgfSxcblxuICB0b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc091dDogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICB0aGlzLl9vcGFjaXR5SW5hY3RpdmUoMjUwKTtcbiAgICB0aGlzLnByb3BzLm9uUHJlc3NPdXQgJiYgdGhpcy5wcm9wcy5vblByZXNzT3V0KGUpO1xuICB9LFxuXG4gIHRvdWNoYWJsZUhhbmRsZVByZXNzOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIHRoaXMucHJvcHMub25QcmVzcyAmJiB0aGlzLnByb3BzLm9uUHJlc3MoZSk7XG4gIH0sXG5cbiAgdG91Y2hhYmxlSGFuZGxlTG9uZ1ByZXNzOiBmdW5jdGlvbihlOiBFdmVudCkge1xuICAgIHRoaXMucHJvcHMub25Mb25nUHJlc3MgJiYgdGhpcy5wcm9wcy5vbkxvbmdQcmVzcyhlKTtcbiAgfSxcblxuICB0b3VjaGFibGVHZXRQcmVzc1JlY3RPZmZzZXQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLnByZXNzUmV0ZW50aW9uT2Zmc2V0IHx8IFBSRVNTX1JFVEVOVElPTl9PRkZTRVQ7XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0SGl0U2xvcDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuaGl0U2xvcDtcbiAgfSxcblxuICB0b3VjaGFibGVHZXRIaWdobGlnaHREZWxheU1TOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheVByZXNzSW4gfHwgMDtcbiAgfSxcblxuICB0b3VjaGFibGVHZXRMb25nUHJlc3NEZWxheU1TOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheUxvbmdQcmVzcyA9PT0gMFxuICAgICAgPyAwXG4gICAgICA6IHRoaXMucHJvcHMuZGVsYXlMb25nUHJlc3MgfHwgNTAwO1xuICB9LFxuXG4gIHRvdWNoYWJsZUdldFByZXNzT3V0RGVsYXlNUzogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuZGVsYXlQcmVzc091dDtcbiAgfSxcblxuICBfb3BhY2l0eUFjdGl2ZTogZnVuY3Rpb24oZHVyYXRpb246IG51bWJlcikge1xuICAgIHRoaXMuc2V0T3BhY2l0eVRvKHRoaXMucHJvcHMuYWN0aXZlT3BhY2l0eSwgZHVyYXRpb24pO1xuICB9LFxuXG4gIF9vcGFjaXR5SW5hY3RpdmU6IGZ1bmN0aW9uKGR1cmF0aW9uOiBudW1iZXIpIHtcbiAgICB0aGlzLnNldE9wYWNpdHlUbyh0aGlzLl9nZXRDaGlsZFN0eWxlT3BhY2l0eVdpdGhEZWZhdWx0KCksIGR1cmF0aW9uKTtcbiAgfSxcblxuICBfZ2V0Q2hpbGRTdHlsZU9wYWNpdHlXaXRoRGVmYXVsdDogZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgY2hpbGRTdHlsZSA9IGZsYXR0ZW5TdHlsZSh0aGlzLnByb3BzLnN0eWxlKSB8fCB7fTtcbiAgICByZXR1cm4gY2hpbGRTdHlsZS5vcGFjaXR5ID09IHVuZGVmaW5lZCA/IDEgOiBjaGlsZFN0eWxlLm9wYWNpdHk7XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPEFuaW1hdGVkLlZpZXdcbiAgICAgICAgYWNjZXNzaWJsZT17dGhpcy5wcm9wcy5hY2Nlc3NpYmxlICE9PSBmYWxzZX1cbiAgICAgICAgYWNjZXNzaWJpbGl0eUxhYmVsPXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlMYWJlbH1cbiAgICAgICAgYWNjZXNzaWJpbGl0eUhpbnQ9e3RoaXMucHJvcHMuYWNjZXNzaWJpbGl0eUhpbnR9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlSb2xlPXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlSb2xlfVxuICAgICAgICBhY2Nlc3NpYmlsaXR5U3RhdGVzPXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlTdGF0ZXN9XG4gICAgICAgIHN0eWxlPXtbdGhpcy5wcm9wcy5zdHlsZSwge29wYWNpdHk6IHRoaXMuc3RhdGUuYW5pbX1dfVxuICAgICAgICBuYXRpdmVJRD17dGhpcy5wcm9wcy5uYXRpdmVJRH1cbiAgICAgICAgdGVzdElEPXt0aGlzLnByb3BzLnRlc3RJRH1cbiAgICAgICAgb25MYXlvdXQ9e3RoaXMucHJvcHMub25MYXlvdXR9XG4gICAgICAgIGlzVFZTZWxlY3RhYmxlPXt0cnVlfVxuICAgICAgICBoYXNUVlByZWZlcnJlZEZvY3VzPXt0aGlzLnByb3BzLmhhc1RWUHJlZmVycmVkRm9jdXN9XG4gICAgICAgIHR2UGFyYWxsYXhQcm9wZXJ0aWVzPXt0aGlzLnByb3BzLnR2UGFyYWxsYXhQcm9wZXJ0aWVzfVxuICAgICAgICBoaXRTbG9wPXt0aGlzLnByb3BzLmhpdFNsb3B9XG4gICAgICAgIG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXI9e3RoaXMudG91Y2hhYmxlSGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXJ9XG4gICAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0PXtcbiAgICAgICAgICB0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdFxuICAgICAgICB9XG4gICAgICAgIG9uUmVzcG9uZGVyR3JhbnQ9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyR3JhbnR9XG4gICAgICAgIG9uUmVzcG9uZGVyTW92ZT17dGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJNb3ZlfVxuICAgICAgICBvblJlc3BvbmRlclJlbGVhc2U9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyUmVsZWFzZX1cbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGU9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRlfT5cbiAgICAgICAge3RoaXMucHJvcHMuY2hpbGRyZW59XG4gICAgICAgIHtUb3VjaGFibGUucmVuZGVyRGVidWdWaWV3KHtcbiAgICAgICAgICBjb2xvcjogJ2N5YW4nLFxuICAgICAgICAgIGhpdFNsb3A6IHRoaXMucHJvcHMuaGl0U2xvcCxcbiAgICAgICAgfSl9XG4gICAgICA8L0FuaW1hdGVkLlZpZXc+XG4gICAgKTtcbiAgfSxcbn0pOiBhbnkpOiBSZWFjdC5Db21wb25lbnRUeXBlPFByb3BzPik7XG5cbm1vZHVsZS5leHBvcnRzID0gVG91Y2hhYmxlT3BhY2l0eTtcbiJdfQ==