3ed18820e7dc8a20b6f8f1c434360b54


'use strict';

var exceptionID = 0;
function reportException(e, isFatal) {
  var _require = require('NativeModules'),
      ExceptionsManager = _require.ExceptionsManager;

  if (ExceptionsManager) {
    var parseErrorStack = require('parseErrorStack');
    var stack = parseErrorStack(e);
    var currentExceptionID = ++exceptionID;
    if (isFatal) {
      ExceptionsManager.reportFatalException(e.message, stack, currentExceptionID);
    } else {
      ExceptionsManager.reportSoftException(e.message, stack, currentExceptionID);
    }
    if (__DEV__) {
      var symbolicateStackTrace = require('symbolicateStackTrace');
      symbolicateStackTrace(stack).then(function (prettyStack) {
        if (prettyStack) {
          ExceptionsManager.updateExceptionMessage(e.message, prettyStack, currentExceptionID);
        } else {
          throw new Error('The stack is null');
        }
      }).catch(function (error) {
        return console.warn('Unable to symbolicate stack trace: ' + error.message);
      });
    }
  }
}

function handleException(e, isFatal) {
  if (!e.message) {
    e = new Error(e);
  }
  if (console._errorOriginal) {
    console._errorOriginal(e.message);
  } else {
    console.error(e.message);
  }
  reportException(e, isFatal);
}

function reactConsoleErrorHandler() {
  console._errorOriginal.apply(console, arguments);
  if (!console.reportErrorsAsExceptions) {
    return;
  }

  if (arguments[0] && arguments[0].stack) {
    reportException(arguments[0], false);
  } else {
    var stringifySafe = require('stringifySafe');
    var str = Array.prototype.map.call(arguments, stringifySafe).join(', ');
    if (str.slice(0, 10) === '"Warning: ') {
      return;
    }
    var error = new Error('console.error: ' + str);
    error.framesToPop = 1;
    reportException(error, false);
  }
}

function installConsoleErrorReporter() {
  if (console._errorOriginal) {
    return;
  }

  console._errorOriginal = console.error.bind(console);
  console.error = reactConsoleErrorHandler;
  if (console.reportErrorsAsExceptions === undefined) {
    console.reportErrorsAsExceptions = true;
  }
}

module.exports = { handleException: handleException, installConsoleErrorReporter: installConsoleErrorReporter };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkV4Y2VwdGlvbnNNYW5hZ2VyLmpzIl0sIm5hbWVzIjpbImV4Y2VwdGlvbklEIiwicmVwb3J0RXhjZXB0aW9uIiwiZSIsImlzRmF0YWwiLCJyZXF1aXJlIiwiRXhjZXB0aW9uc01hbmFnZXIiLCJwYXJzZUVycm9yU3RhY2siLCJzdGFjayIsImN1cnJlbnRFeGNlcHRpb25JRCIsInJlcG9ydEZhdGFsRXhjZXB0aW9uIiwibWVzc2FnZSIsInJlcG9ydFNvZnRFeGNlcHRpb24iLCJfX0RFVl9fIiwic3ltYm9saWNhdGVTdGFja1RyYWNlIiwidGhlbiIsInByZXR0eVN0YWNrIiwidXBkYXRlRXhjZXB0aW9uTWVzc2FnZSIsIkVycm9yIiwiY2F0Y2giLCJjb25zb2xlIiwid2FybiIsImVycm9yIiwiaGFuZGxlRXhjZXB0aW9uIiwiX2Vycm9yT3JpZ2luYWwiLCJyZWFjdENvbnNvbGVFcnJvckhhbmRsZXIiLCJhcHBseSIsImFyZ3VtZW50cyIsInJlcG9ydEVycm9yc0FzRXhjZXB0aW9ucyIsInN0cmluZ2lmeVNhZmUiLCJzdHIiLCJBcnJheSIsInByb3RvdHlwZSIsIm1hcCIsImNhbGwiLCJqb2luIiwic2xpY2UiLCJmcmFtZXNUb1BvcCIsImluc3RhbGxDb25zb2xlRXJyb3JSZXBvcnRlciIsImJpbmQiLCJ1bmRlZmluZWQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQVVBOztBQU9BLElBQUlBLGNBQWMsQ0FBbEI7QUFDQSxTQUFTQyxlQUFULENBQXlCQyxDQUF6QixFQUEyQ0MsT0FBM0MsRUFBNkQ7QUFBQSxpQkFDL0JDLFFBQVEsZUFBUixDQUQrQjtBQUFBLE1BQ3BEQyxpQkFEb0QsWUFDcERBLGlCQURvRDs7QUFFM0QsTUFBSUEsaUJBQUosRUFBdUI7QUFDckIsUUFBTUMsa0JBQWtCRixRQUFRLGlCQUFSLENBQXhCO0FBQ0EsUUFBTUcsUUFBUUQsZ0JBQWdCSixDQUFoQixDQUFkO0FBQ0EsUUFBTU0scUJBQXFCLEVBQUVSLFdBQTdCO0FBQ0EsUUFBSUcsT0FBSixFQUFhO0FBQ1hFLHdCQUFrQkksb0JBQWxCLENBQ0VQLEVBQUVRLE9BREosRUFFRUgsS0FGRixFQUdFQyxrQkFIRjtBQUtELEtBTkQsTUFNTztBQUNMSCx3QkFBa0JNLG1CQUFsQixDQUNFVCxFQUFFUSxPQURKLEVBRUVILEtBRkYsRUFHRUMsa0JBSEY7QUFLRDtBQUNELFFBQUlJLE9BQUosRUFBYTtBQUNYLFVBQU1DLHdCQUF3QlQsUUFBUSx1QkFBUixDQUE5QjtBQUNBUyw0QkFBc0JOLEtBQXRCLEVBQ0dPLElBREgsQ0FDUSx1QkFBZTtBQUNuQixZQUFJQyxXQUFKLEVBQWlCO0FBQ2ZWLDRCQUFrQlcsc0JBQWxCLENBQ0VkLEVBQUVRLE9BREosRUFFRUssV0FGRixFQUdFUCxrQkFIRjtBQUtELFNBTkQsTUFNTztBQUNMLGdCQUFNLElBQUlTLEtBQUosQ0FBVSxtQkFBVixDQUFOO0FBQ0Q7QUFDRixPQVhILEVBWUdDLEtBWkgsQ0FZUztBQUFBLGVBQ0xDLFFBQVFDLElBQVIsQ0FBYSx3Q0FBd0NDLE1BQU1YLE9BQTNELENBREs7QUFBQSxPQVpUO0FBZUQ7QUFDRjtBQUNGOztBQVVELFNBQVNZLGVBQVQsQ0FBeUJwQixDQUF6QixFQUFtQ0MsT0FBbkMsRUFBcUQ7QUFLbkQsTUFBSSxDQUFDRCxFQUFFUSxPQUFQLEVBQWdCO0FBQ2RSLFFBQUksSUFBSWUsS0FBSixDQUFVZixDQUFWLENBQUo7QUFDRDtBQUNELE1BQUlpQixRQUFRSSxjQUFaLEVBQTRCO0FBQzFCSixZQUFRSSxjQUFSLENBQXVCckIsRUFBRVEsT0FBekI7QUFDRCxHQUZELE1BRU87QUFDTFMsWUFBUUUsS0FBUixDQUFjbkIsRUFBRVEsT0FBaEI7QUFDRDtBQUNEVCxrQkFBZ0JDLENBQWhCLEVBQW1CQyxPQUFuQjtBQUNEOztBQUVELFNBQVNxQix3QkFBVCxHQUFvQztBQUNsQ0wsVUFBUUksY0FBUixDQUF1QkUsS0FBdkIsQ0FBNkJOLE9BQTdCLEVBQXNDTyxTQUF0QztBQUNBLE1BQUksQ0FBQ1AsUUFBUVEsd0JBQWIsRUFBdUM7QUFDckM7QUFDRDs7QUFFRCxNQUFJRCxVQUFVLENBQVYsS0FBZ0JBLFVBQVUsQ0FBVixFQUFhbkIsS0FBakMsRUFBd0M7QUFDdENOLG9CQUFnQnlCLFVBQVUsQ0FBVixDQUFoQixFQUE0QyxLQUE1QztBQUNELEdBRkQsTUFFTztBQUNMLFFBQU1FLGdCQUFnQnhCLFFBQVEsZUFBUixDQUF0QjtBQUNBLFFBQU15QixNQUFNQyxNQUFNQyxTQUFOLENBQWdCQyxHQUFoQixDQUFvQkMsSUFBcEIsQ0FBeUJQLFNBQXpCLEVBQW9DRSxhQUFwQyxFQUFtRE0sSUFBbkQsQ0FBd0QsSUFBeEQsQ0FBWjtBQUNBLFFBQUlMLElBQUlNLEtBQUosQ0FBVSxDQUFWLEVBQWEsRUFBYixNQUFxQixZQUF6QixFQUF1QztBQUlyQztBQUNEO0FBQ0QsUUFBTWQsUUFBdUIsSUFBSUosS0FBSixDQUFVLG9CQUFvQlksR0FBOUIsQ0FBN0I7QUFDQVIsVUFBTWUsV0FBTixHQUFvQixDQUFwQjtBQUNBbkMsb0JBQWdCb0IsS0FBaEIsRUFBcUMsS0FBckM7QUFDRDtBQUNGOztBQU1ELFNBQVNnQiwyQkFBVCxHQUF1QztBQUVyQyxNQUFJbEIsUUFBUUksY0FBWixFQUE0QjtBQUMxQjtBQUNEOztBQUVESixVQUFRSSxjQUFSLEdBQXlCSixRQUFRRSxLQUFSLENBQWNpQixJQUFkLENBQW1CbkIsT0FBbkIsQ0FBekI7QUFDQUEsVUFBUUUsS0FBUixHQUFnQkcsd0JBQWhCO0FBQ0EsTUFBSUwsUUFBUVEsd0JBQVIsS0FBcUNZLFNBQXpDLEVBQW9EO0FBR2xEcEIsWUFBUVEsd0JBQVIsR0FBbUMsSUFBbkM7QUFDRDtBQUNGOztBQUVEYSxPQUFPQyxPQUFQLEdBQWlCLEVBQUNuQixnQ0FBRCxFQUFrQmUsd0RBQWxCLEVBQWpCIiwiZmlsZSI6IkV4Y2VwdGlvbnNNYW5hZ2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZm9ybWF0XG4gKiBAZmxvd1xuICovXG5cbid1c2Ugc3RyaWN0JztcblxuaW1wb3J0IHR5cGUge0V4dGVuZGVkRXJyb3J9IGZyb20gJ3BhcnNlRXJyb3JTdGFjayc7XG5cbi8qKlxuICogSGFuZGxlcyB0aGUgZGV2ZWxvcGVyLXZpc2libGUgYXNwZWN0IG9mIGVycm9ycyBhbmQgZXhjZXB0aW9uc1xuICovXG5sZXQgZXhjZXB0aW9uSUQgPSAwO1xuZnVuY3Rpb24gcmVwb3J0RXhjZXB0aW9uKGU6IEV4dGVuZGVkRXJyb3IsIGlzRmF0YWw6IGJvb2xlYW4pIHtcbiAgY29uc3Qge0V4Y2VwdGlvbnNNYW5hZ2VyfSA9IHJlcXVpcmUoJ05hdGl2ZU1vZHVsZXMnKTtcbiAgaWYgKEV4Y2VwdGlvbnNNYW5hZ2VyKSB7XG4gICAgY29uc3QgcGFyc2VFcnJvclN0YWNrID0gcmVxdWlyZSgncGFyc2VFcnJvclN0YWNrJyk7XG4gICAgY29uc3Qgc3RhY2sgPSBwYXJzZUVycm9yU3RhY2soZSk7XG4gICAgY29uc3QgY3VycmVudEV4Y2VwdGlvbklEID0gKytleGNlcHRpb25JRDtcbiAgICBpZiAoaXNGYXRhbCkge1xuICAgICAgRXhjZXB0aW9uc01hbmFnZXIucmVwb3J0RmF0YWxFeGNlcHRpb24oXG4gICAgICAgIGUubWVzc2FnZSxcbiAgICAgICAgc3RhY2ssXG4gICAgICAgIGN1cnJlbnRFeGNlcHRpb25JRCxcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIEV4Y2VwdGlvbnNNYW5hZ2VyLnJlcG9ydFNvZnRFeGNlcHRpb24oXG4gICAgICAgIGUubWVzc2FnZSxcbiAgICAgICAgc3RhY2ssXG4gICAgICAgIGN1cnJlbnRFeGNlcHRpb25JRCxcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICBjb25zdCBzeW1ib2xpY2F0ZVN0YWNrVHJhY2UgPSByZXF1aXJlKCdzeW1ib2xpY2F0ZVN0YWNrVHJhY2UnKTtcbiAgICAgIHN5bWJvbGljYXRlU3RhY2tUcmFjZShzdGFjaylcbiAgICAgICAgLnRoZW4ocHJldHR5U3RhY2sgPT4ge1xuICAgICAgICAgIGlmIChwcmV0dHlTdGFjaykge1xuICAgICAgICAgICAgRXhjZXB0aW9uc01hbmFnZXIudXBkYXRlRXhjZXB0aW9uTWVzc2FnZShcbiAgICAgICAgICAgICAgZS5tZXNzYWdlLFxuICAgICAgICAgICAgICBwcmV0dHlTdGFjayxcbiAgICAgICAgICAgICAgY3VycmVudEV4Y2VwdGlvbklELFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgc3RhY2sgaXMgbnVsbCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVycm9yID0+XG4gICAgICAgICAgY29uc29sZS53YXJuKCdVbmFibGUgdG8gc3ltYm9saWNhdGUgc3RhY2sgdHJhY2U6ICcgKyBlcnJvci5tZXNzYWdlKSxcbiAgICAgICAgKTtcbiAgICB9XG4gIH1cbn1cblxuZGVjbGFyZSB2YXIgY29uc29sZTogdHlwZW9mIGNvbnNvbGUgJiB7XG4gIF9lcnJvck9yaWdpbmFsOiBGdW5jdGlvbixcbiAgcmVwb3J0RXJyb3JzQXNFeGNlcHRpb25zOiBib29sZWFuLFxufTtcblxuLyoqXG4gKiBMb2dzIGV4Y2VwdGlvbnMgdG8gdGhlIChuYXRpdmUpIGNvbnNvbGUgYW5kIGRpc3BsYXlzIHRoZW1cbiAqL1xuZnVuY3Rpb24gaGFuZGxlRXhjZXB0aW9uKGU6IEVycm9yLCBpc0ZhdGFsOiBib29sZWFuKSB7XG4gIC8vIFdvcmthcm91bmQgZm9yIHJlcG9ydGluZyBlcnJvcnMgY2F1c2VkIGJ5IGB0aHJvdyAnc29tZSBzdHJpbmcnYFxuICAvLyBVbmZvcnR1bmF0ZWx5IHRoZXJlIGlzIG5vIHdheSB0byBmaWd1cmUgb3V0IHRoZSBzdGFja3RyYWNlIGluIHRoaXNcbiAgLy8gY2FzZSwgc28gaWYgeW91IGVuZGVkIHVwIGhlcmUgdHJ5aW5nIHRvIHRyYWNlIGFuIGVycm9yLCBsb29rIGZvclxuICAvLyBgdGhyb3cgJzxlcnJvciBtZXNzYWdlPidgIHNvbWV3aGVyZSBpbiB5b3VyIGNvZGViYXNlLlxuICBpZiAoIWUubWVzc2FnZSkge1xuICAgIGUgPSBuZXcgRXJyb3IoZSk7XG4gIH1cbiAgaWYgKGNvbnNvbGUuX2Vycm9yT3JpZ2luYWwpIHtcbiAgICBjb25zb2xlLl9lcnJvck9yaWdpbmFsKGUubWVzc2FnZSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5lcnJvcihlLm1lc3NhZ2UpO1xuICB9XG4gIHJlcG9ydEV4Y2VwdGlvbihlLCBpc0ZhdGFsKTtcbn1cblxuZnVuY3Rpb24gcmVhY3RDb25zb2xlRXJyb3JIYW5kbGVyKCkge1xuICBjb25zb2xlLl9lcnJvck9yaWdpbmFsLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XG4gIGlmICghY29uc29sZS5yZXBvcnRFcnJvcnNBc0V4Y2VwdGlvbnMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoYXJndW1lbnRzWzBdICYmIGFyZ3VtZW50c1swXS5zdGFjaykge1xuICAgIHJlcG9ydEV4Y2VwdGlvbihhcmd1bWVudHNbMF0sIC8qIGlzRmF0YWwgKi8gZmFsc2UpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHN0cmluZ2lmeVNhZmUgPSByZXF1aXJlKCdzdHJpbmdpZnlTYWZlJyk7XG4gICAgY29uc3Qgc3RyID0gQXJyYXkucHJvdG90eXBlLm1hcC5jYWxsKGFyZ3VtZW50cywgc3RyaW5naWZ5U2FmZSkuam9pbignLCAnKTtcbiAgICBpZiAoc3RyLnNsaWNlKDAsIDEwKSA9PT0gJ1wiV2FybmluZzogJykge1xuICAgICAgLy8gUmVhY3Qgd2FybmluZ3MgdXNlIGNvbnNvbGUuZXJyb3Igc28gdGhhdCBhIHN0YWNrIHRyYWNlIGlzIHNob3duLCBidXRcbiAgICAgIC8vIHdlIGRvbid0IChjdXJyZW50bHkpIHdhbnQgdGhlc2UgdG8gc2hvdyBhIHJlZGJveFxuICAgICAgLy8gKE5vdGU6IExvZ2ljIGR1cGxpY2F0ZWQgaW4gcG9seWZpbGxzL2NvbnNvbGUuanMuKVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBlcnJvcjogRXh0ZW5kZWRFcnJvciA9IG5ldyBFcnJvcignY29uc29sZS5lcnJvcjogJyArIHN0cik7XG4gICAgZXJyb3IuZnJhbWVzVG9Qb3AgPSAxO1xuICAgIHJlcG9ydEV4Y2VwdGlvbihlcnJvciwgLyogaXNGYXRhbCAqLyBmYWxzZSk7XG4gIH1cbn1cblxuLyoqXG4gKiBTaG93cyBhIHJlZGJveCB3aXRoIHN0YWNrdHJhY2UgZm9yIGFsbCBjb25zb2xlLmVycm9yIG1lc3NhZ2VzLiAgRGlzYWJsZSBieVxuICogc2V0dGluZyBgY29uc29sZS5yZXBvcnRFcnJvcnNBc0V4Y2VwdGlvbnMgPSBmYWxzZTtgIGluIHlvdXIgYXBwLlxuICovXG5mdW5jdGlvbiBpbnN0YWxsQ29uc29sZUVycm9yUmVwb3J0ZXIoKSB7XG4gIC8vIEVuYWJsZSByZXBvcnRFcnJvcnNBc0V4Y2VwdGlvbnNcbiAgaWYgKGNvbnNvbGUuX2Vycm9yT3JpZ2luYWwpIHtcbiAgICByZXR1cm47IC8vIGFscmVhZHkgaW5zdGFsbGVkXG4gIH1cbiAgLy8gRmxvdyBkb2Vzbid0IGxpa2UgaXQgd2hlbiB5b3Ugc2V0IGFyYml0cmFyeSB2YWx1ZXMgb24gYSBnbG9iYWwgb2JqZWN0XG4gIGNvbnNvbGUuX2Vycm9yT3JpZ2luYWwgPSBjb25zb2xlLmVycm9yLmJpbmQoY29uc29sZSk7XG4gIGNvbnNvbGUuZXJyb3IgPSByZWFjdENvbnNvbGVFcnJvckhhbmRsZXI7XG4gIGlmIChjb25zb2xlLnJlcG9ydEVycm9yc0FzRXhjZXB0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gSW5kaXZpZHVhbCBhcHBzIGNhbiBkaXNhYmxlIHRoaXNcbiAgICAvLyBGbG93IGRvZXNuJ3QgbGlrZSBpdCB3aGVuIHlvdSBzZXQgYXJiaXRyYXJ5IHZhbHVlcyBvbiBhIGdsb2JhbCBvYmplY3RcbiAgICBjb25zb2xlLnJlcG9ydEVycm9yc0FzRXhjZXB0aW9ucyA9IHRydWU7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7aGFuZGxlRXhjZXB0aW9uLCBpbnN0YWxsQ29uc29sZUVycm9yUmVwb3J0ZXJ9O1xuIl19